# BuildOS — Формулы сметы и бизнес-правила (v0)

## 1) Базовые принципы
- Каждая смета принадлежит объекту и имеет **версию** (v1, v2, …).
- Всегда считаются **две суммы**:
  - Цена для клиента (Revenue)
  - Себестоимость (Cost)
- Маржа = Revenue − Cost

## 2) Базовые единицы измерения
- м² — площадь (пол, стены, потолок)
- пог.м — периметр (плинтуса, короба)
- шт — элементы (розетки, точки света)
- комплект — узлы (санузел, кухня)

## 3) Формула площади
- Пол: `длина × ширина`
- Стены: `периметр × высота`
- Потолок: `площадь пола`

## 4) Структура расчёта
### Для каждой позиции:
```
Количество × Цена_работы = Стоимость_работы
Количество × Норма_материала × Цена_материала = Стоимость_материала
```

### Итог:
```
Cost = Σ(работы + материалы + субподряд)
Revenue = Cost × (1 + Маржа%)
```

## 5) Коэффициенты (multipliers)
- Сложность объекта: 1.0 – 1.5
- Срочность: 1.0 – 1.3
- Состояние (вторичка): 1.0 – 1.2
- Этаж без лифта: 1.05 – 1.15

`Итоговая цена = Базовая × все коэффициенты`

## 6) Минимальные суммы
- Минимальная стоимость этапа
- Минимальная стоимость объекта

Если расчёт < минимума → применяется минимум.

## 7) Округления
- До 1 злотого (PLN)
- Количество — до 0.01

## 8) Версионность сметы
- Каждое изменение создаёт новую версию
- Хранится разница:
  - +/− Revenue
  - +/− Cost
  - +/− Маржа

## 9) Статусы сметы
- Черновик
- Отправлено клиенту
- Согласовано
- В работе
- Закрыто

## 10) Локализация
- Все формулы универсальны
- Названия работ и материалов переводимые (RU/PL)

